---
layout: post
title: Question de conception de base de donn&#233;e
tags : [base de donn&#233;e, conception]
---

R&#233;cemment nous avons eu une petite probl&#233;matique de mod&#233;lisation de base de donn&#233; et je me suis dis 
que ce serait amusant et int&#233;ressant de la partager, ce que je me propose de faire dans ce post.

## Probl&#233;matique

Le besoin fonctionnel consiste &#224; tracer des &#233;changes de messages entre des utilisateurs et des clients.

La probl&#233;matique tient au fait que selon le sens de la conversation l'&#233;metteur du message peut &#234;tre un utilisateur 
ou bien un client (il en est de m&#234;me pour le destinataire du message).

Quel mod&#232;le adopter pour la base de donn&#233;?

## Mod&#233;lisation

Nous disposons de deux tables, `UTILISATEUR` et `CLIENT`, qui contiennent respectivement les utilisateurs et les clients. 

Nous avons cr&#233;&#233; une table `CORRESPONDANT` qui contient les correspondants (&#233;metteurs et destinataires des messages) avec 
les attributs suivants :

- `id_correspondant` : identifiant technique
- `id_acteur` : identifiant de l'utilisateur ou du client
- `type` : ce champ sert &#224; identifier si la valeur de `id_acteur` correspond &#224; l'identifiant d'un utilisateur 
ou d'un client (comme il n'y a que deux types de correspondant ce champ peut &#234;tre un champ de type `boolean`)

ainsi qu'une table `MESSAGE` qui contient les messages avec les champs suivants:

- `id_message` : identifiant technique
- `id_emetteur` : identifiant (`id_correspondant`) du correspondant &#224; l'initiative du message
- `id_destinataire` : identifiant (`id_correspondant`) du correspondant &#224; qui le message est adress&#233;
- `message` : le message &#233;chang&#233;

## Analyse

### Avantages

Nous avons retenu ce choix de mod&#233;lisation car il *d&#233;couple* la probl&#233;matique 
de gestion des messages de celle d'avoir des interlocuteurs de diff&#233;rentes natures (utilisateur/client).

En effet un message ne sait rien d'un &#233;ventuel utilisateur ou client. En ce qui le concerne, il n'a connaissance 
que d'un correspondant &#233;metteur et d'un autre r&#233;cepteur. Ainsi pour r&#233;aliser le d&#233;couplage nous 
avons introduit une *nouvelle abstraction*, celle de correspondant.

### Inconv&#233;nients

La mod&#233;lisation de la table `CORRESPONDANT` nous fait perdre l'int&#233;gri&#233;t&#233; r&#233;f&#233;rentielle sur 
les identifiants d'utilisateur et de client.

Un moyen de lever cette limitation serait de modifier la table ainsi :

- `id_correspondant` : identifiant technique
- `id_utilisateur` : identifiant de l'utilisateur (avec `foreign key` sur la table `UTILISATEUR`)
- `id_client` : identifiant du client (avec `foreign key` sur la table `CLIENT`)

## Conclusion

Je ne sais pas si notre solution est id&#233;ale mais j'esp&#232;re qu'elle aura au moins eu le m&#233;rite de vous avoir mis sur la route de la votre.
 
